
@@ -34,8 +43,11 @@
 
     public ContainerWorkbench(int i, PlayerInventory playerinventory, ContainerAccess containeraccess) {
         super(Containers.CRAFTING, i);
-        this.craftSlots = new InventoryCrafting(this, 3, 3);
+        // CraftBukkit start - Switched order of IInventory construction and stored player
         this.resultSlots = new InventoryCraftResult();
+        this.craftSlots = new InventoryCrafting(this, 3, 3, playerinventory.player); // CraftBukkit - pass player
+        this.craftSlots.resultInventory = this.resultSlots;
+        // CraftBukkit end
         this.access = containeraccess;
         this.player = playerinventory.player;
         this.addSlot(new SlotResult(playerinventory.player, this.craftSlots, this.resultSlots, 0, 124, 35));
@@ -78,6 +90,7 @@
                     }
                 }
             }
+            itemstack = org.bukkit.craftbukkit.event.CraftEventFactory.callPreCraftEvent(inventorycrafting, inventorycraftresult, itemstack, container.getBukkitView(), optional.orElse(null) instanceof RecipeRepair); // CraftBukkit
 
             inventorycraftresult.setItem(0, itemstack);
             container.setRemoteSlot(0, itemstack);
@@ -118,6 +131,7 @@
 
     @Override
     public boolean stillValid(EntityHuman entityhuman) {
+        if (!this.checkReachable) return true; // CraftBukkit
         return stillValid(this.access, entityhuman, Blocks.CRAFTING_TABLE);
     }
 
@@ -206,4 +220,17 @@
